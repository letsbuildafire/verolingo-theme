{% extends 'components/dropdown.html.twig' %}
{% set id = id|defined('language') %}

{% block classes "dropdown--language #{classes|join(' ')}" %}

{% block text "#{native_name(langswitcher.current)|capitalize} <i></i>" %}

{% block menu %}
    {% for language in langswitcher.languages if (language != langswitcher.current) %}
        {% set base_lang_url = base_url_simple ~ grav.language.getLanguageURLPrefix(language) %}
        {% set lang_url = base_lang_url ~ langswitcher.page_route ~ page.urlExtension %}
        {% set untranslated_pages_behavior = grav.config.plugins.langswitcher.untranslated_pages_behavior %}
        {% if untranslated_pages_behavior != 'none' %}
            {% set translated_page = langswitcher.translated_pages[language] %}
            {% if (not translated_page) or (not translated_page.published) %}
                {% if untranslated_pages_behavior == 'redirect' %}
                    {% set lang_url = base_lang_url ~ '/' %}
                {% elseif untranslated_pages_behavior == 'hide' %}
                    {% set show_language = false %}
                {% endif %}
            {% endif %}
        {% endif %}
        {% set active_class = '' %}

        <a class="dropdown__item dropdown__item--language {{active_class}}" href="{{ lang_url ~ uri.params }}">
            {{native_name(language)|capitalize}}
        </a>
    {% endfor %}
{% endblock %}
